server {
    listen 80;

    # Primary rule for the React application
    location / {
        root /usr/share/nginx/html;
        index index.html;
        try_files $uri $uri/ /index.html;
    }

    # Proxy rule for Products Service
    location /api/products/ {
        # proxy_pass uses the internal Kubernetes Service name and port
        proxy_pass http://products-service:3001/; 
    }

    # Proxy rule for User Service
    location /api/user/ {
        proxy_pass http://user-service:3002/;
    }
    
    # Proxy rule for Cart Service
    location /api/cart/ {
        proxy_pass http://cart-service:3003/;
    }
}